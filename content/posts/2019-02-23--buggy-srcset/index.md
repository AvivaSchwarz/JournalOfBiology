---
title: Buggy srcset
tags: ["bug"]
cover: mailboxes2.jpg
author: baobab koodaa
---

This page demoes a srcset bug in Gatsby. It's causing unnecessarily large images to be loaded.

<re-image src="mailboxes2.jpg" fluid=1 opacity=1 title="Photo by Mathyas Kurmann on Unsplash"></re-image>

Open the network tab in devtools, refresh the page and filter for webp, then open the loaded image in another tab.
You will see that it's huge compared to the 800px wide container where it's displayed. Even if you resize the browser
to a tiny width, the browser will still load the largest possible version of the image.

Here is the image srcset:

```javascript
<source type="image/webp" srcset="
/static/be21c7dd0d11c74c18530fc39aefa922/10917/mailboxes.webp 200w,
/static/be21c7dd0d11c74c18530fc39aefa922/21f2d/mailboxes.webp 400w,
/static/be21c7dd0d11c74c18530fc39aefa922/fdc6a/mailboxes.webp 800w,
/static/be21c7dd0d11c74c18530fc39aefa922/e7f3d/mailboxes.webp 1200w,
/static/be21c7dd0d11c74c18530fc39aefa922/faacb/mailboxes.webp 1600w,
/static/be21c7dd0d11c74c18530fc39aefa922/acdd2/mailboxes.webp 1800w" 
sizes="(max-width: 800px) 100vw, 800px">
```

It looks like the problem is the `sizes` definition, which should be giving the browser options of what to do depending
on the viewport width. For some reason, there is only one option (and the browser is not choosing that option anyway?). Weird..

The `srcset` and `sizes` are generated by image-sharp. My GraphQL looks like this:

```javascript
edges {
  node {
    childImageSharp {
      fluid(maxWidth: 800, quality: 90, traceSVG: { color: "#f9ebd2" }) {
          originalImg
          tracedSVG
          src
          srcSet
          aspectRatio
          srcSetWebp
          sizes
      }
    }
  }
}
```

I'm creating the `<picture>` with gatsby-image like this: `<Picture fluid={fluid} />`.

It doesn't look like I'm doing anything to cause this behavior, and there aren't any options for me to specify what I want from scrset or sizes. So I think this is a bug.
